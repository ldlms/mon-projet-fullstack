generator client {
  provider = "prisma-client"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
}

model Card {
  id            String          @id
  name          String
  oracleText    String?
  manaValue     Int
  types         CardType[]
  supertypes    CardSupertype[]
  subtypes      String[]
  colors        Color[]
  colorIdentity Color[]
  power         String?
  toughness     String?
  loyalty       String?
  defense       String?
  createdAt     DateTime        @default(now())
  imageUrl      String?
  scryfallOracleId String?         @unique
  legalities    CardLegality[]
  manaCost      CardMana[]
  printings     String[]

  @@index([name])
}

model CardMana {
  id     Int    @id @default(autoincrement())
  cardId String
  color  Color?
  amount Int
  card   Card   @relation(fields: [cardId], references: [id], onDelete: Cascade)

  @@unique([cardId, color])
}

model CardLegality {
  cardId String
  format DeckFormat
  legal  Boolean
  card   Card       @relation(fields: [cardId], references: [id], onDelete: Cascade)

  @@id([cardId, format])
}

enum Color {
  W
  U
  B
  R
  G
}

enum CardType {
  Creature
  Sorcery
  Instant
  Artifact
  Enchantment
  Land
  Planeswalker
  Battle
}

enum CardSupertype {
  Legendary
  Basic
  Snow
}

enum DeckFormat {
  Standard
  Pioneer
  Modern
  Legacy
  Vintage
  Commander
  Pauper
  Historic
}

enum DeckVisibility {
  Private
  Unlisted
  Public
}
